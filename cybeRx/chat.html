<!DOCTYPE html>
<html>
<head>
	<title>CybeRx: Chat</title>
	<link rel = "stylesheet" type = "text/css" href = "summerproject1.css"> 
    <link href="https://fonts.googleapis.com/css?family=Montserrat|Montserrat+Alternates&display=swap" rel="stylesheet">
   <link href="https://fonts.googleapis.com/css?family=Audiowide|Montserrat|Montserrat+Alternates&display=swap" rel="stylesheet">
   <script src="https://code.jquery.com/jquery-3.4.1.js" integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU=" crossorigin="anonymous"></script>
   <link rel="icon" href="Final Logo.jpg">



   <script>
   	userChat = [];
   	botChat = [];

   	function characterBreak(str){
   		var final = "";
   		var words = 0;
   		for (var i = 0; i < str.length; i++) {
  			var wo
  			if(str.charAt(i) == " "){
  				words++;
  			} if(words == 6){
  				final = final + "<br>" + str.charAt(i);
  				words = 0;
  			}

  			else {
  				final = final + str.charAt(i);
  			}
		}

		return final;
	}

	function convertNum(str){
		
	}

   			var type11 = false;

            function talk() {

                var user = document.getElementById("userBox").value;
                document.getElementById("userBox").value = "";
                document.getElementById("chat").innerHTML += "<div id = \"youLog\" class = \"chatting\">" + user + "</div><br>";
                if (user == 1) {
                	var string = "Which doctor are you looking for?<br> Press 11 if you are looking for a specific name. <br>ex. <i>David Smith</i><br>Press 12 if you are looking for a specific type of practicioner.<br> ex. <i>Cardiologist near me</i>"
                    document.getElementById("chat").innerHTML += "<div id = \"botLog\" class = \"chatting\">" + string + "</div><br><br>";
                    userChat.push(user);
                    botChat.push(string);
                } else if(user == 11){
                	var string = "Type in the name of the practitioner you are searching for."
                	document.getElementById("chat").innerHTML += "<div id = \"botLog\" class = \"chatting\">" + string + "</div><br>";
                    userChat.push(user);
                    botChat.push(string);
                    type11 = true;
                } else if(type11 == true){
                	type11 = false;
                	var string = "Nice Doctor name!";
                	var separate = user.split(" ");
                	var firstName = separate[0];
                	var lastName = separate[1];
                    var info = "";
                    var other = "";
                    var address = "";
                    var phoneNumber = "";
                    $.getJSON("https://api.betterdoctor.com/2016-03-01/doctors?first_name=" + firstName + "&last_name=" + lastName + "&skip=0&limit=10&user_key=afbd778310f54f209917a0810b0f8aed",
							function(data){
							console.log(data);
							console.log(data.data[0].profile.bio);
							info += "Dr." +  data.data[0].profile.first_name + " " + data.data[0].profile.last_name + ", " + data.data[0].profile.title + "<br>" + data.data[0].specialties[0].name + "<br><br>";

							var datas = data.data[0];

							if(datas.practices[0] != null){
								address = "<br>" + data.data[0].practices[0].visit_address.street + "<br>" + data.data[0].practices[0].visit_address.city + ", " + data.data[0].practices[0].visit_address.state + " " + data.data[0].practices[0].visit_address.zip + "<br>";
								phoneNumber = "<br>" + data.data[0].practices[0].phones[0].number;
							}
							
							info += address;
							info += phoneNumber;
							document.getElementById("chat").innerHTML += "<div id = \"botLog\" class = \"chatting\">" + info + "</div><br><br>";
                    		userChat.push(user);
                    		botChat.push(characterBreak(info));
					});
                }


                else {
                    document.getElementById("chat").innerHTML += "<div id = \"botLog\" class = \"chatting\">" + "I'm sorry I can't parse your text properly<br> Please try typing in one of the options, shown in the welcome statement. <br>" + "</div><br>";
                    userChat.push(user);
                    botChat.push("I'm sorry I cannot interpret your input properly.<br> Please try typing in one of the options, shown in the welcome statement. <br>");
                }

        
            } 
   </script>



<body>
</head>
	<ul>
  <li><a href="summerproject1.html">Log Out</a></li>
  <li><a href="chat.html">Chat</a></li>
  <li><a href="summerproject1.html">View my Stats</a></li>
  <li><a href = "summerproject1.htm">Documentation</a></li>
  <div id = "words"><li><a href="summerproject1.html" id="logo2">CybeRx</a></li></div>
  <li id = "logo"><img id = "logo" src = "Logo.png"></li>
</ul>

<div id = "nonsense" style="padding:20px;margin-top:30px;background:url(unblurred.png);height:100%; width: screen; background-size: cover;">

	<div id="chatLog">Chat<br>
		<div id = "chat">
			<div id = "botLog" class = "chatting">Hi, I'm CybeRx, your personal healthcare assistant. How may I help you today?<br>Press 1 To try to find a Doctor<br>Press 2 to try to find possible diagnosis for your symptoms, <br> Press 3 to take a brief health assessment. </div><br>
		</div>
    </div>
    <div class = "response"><input id="userBox" type="text" onkeydown="if (event.keyCode == 13) {talk()}"></div>
	</div>


</div>

</body>
</html>